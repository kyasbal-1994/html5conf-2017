# パフォーマンスの懸念

* その前にそのWebGLの利用は本当に必要?
    * 当然ネイティヴで実装されているタグの方が早い
    * **Webで開けることに価値がある?**
    * **既存のHTML/CSSではできない?**
    * **そもそもその表現に意味がある?**

# パフォーマンスの懸念

* 何が**「重い」**のか
    * **「ページの読み込み速度」**が重い
        * 表示まで何秒かけられる?
        * プログレスバーとかでごまかせない?
    * **「操作やフレームがカクついて」**重い
        * 1秒に何フレーム欲しい?
        * 余計な呼び出しはない? (Spector.jsなどで調べる)
        * HTMLタグ/CSSの併用も考える

# 読み込み速度問題

* 何が重いか?
    * やっぱり一番重いのは**モデル**
        * **モデルを使わない**という選択肢も大事
        * コンテンツごとに異なりうる
        (キャッシュの効果が低そう)
        * Webエンジニアのノウハウが少ない

# モデルの読み込み速度の問題

* そもそも**モデルデータ**とは
    * 頂点座標、法線、テクスチャ座標など各点ごとに記録した**頂点情報**
    * どの頂点同士をつないで面を作るかの**インデックス情報**
    * どのシェーダー、どのパラメーターで描画するかの**マテリアル情報**
    * **ボーンの情報**

# モデルの読み込み速度の問題

* さらに多種の**テクスチャ**
![materials](./resources/materials.png)

# モデルの読み込み速度の問題

* 場合によっては以下も含みうる
    * 物理演算の剛体情報
    * 編集時に必要なデータ
    * アニメーションデータ
    * CADなどはより細かい物性のデータ

# モデルの読み込み速度の問題

* **適切なモデルファイルを採用しなければ無駄なデータが多い**
* モデルファイルは何を使っている?
    * FBX?
    * COLLADA?
    * **glTF**?

# glTF

* **Khronos**が標準化しようとしているモデルフォーマット
* **3Dフォーマットにおけるjpgを目指す**
![](https://www.khronos.org/assets/uploads/apis/2016-gltf-jpeg-of-3d.jpg)
# glTF

* 各種エクスポーター/コンバーターもある
* **ランタイム時のための**モデルフォーマット
    * 編集が目的ではない
    * JSでのパースが非常に容易
    * WebGLでの表示が非常に楽
    * 無駄なデータが省かれた

# glTF

* Paint3Dにも出力機能がついた(glTFにはMSも積極的)
* Sketchfabで100000以上のモデルがダウンロード可能
* Apple Watchのページでも使われた
* 2.0の仕様の策定が最終段階
    * PBR
    * スキンアニメーション

# draco

* Googleの公開している頂点情報の**圧縮用フォーマット**
* **4倍 - 12倍**程度圧縮できる
* MP4(glTF)とH.264(draco)のような関係
* glTFにdraco用の拡張仕様がある
* デコーダーが公開されているが**1MB近くある**
(WASM版はもっと小さい)
